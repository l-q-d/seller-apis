# Автоматизация обновления цен и остатков на Яндекс.Маркете и Ozon

Этот проект предоставляет скрипты для автоматического обновления цен и остатков товаров на маркетплейсах Яндекс.Маркет и Ozon. Скрипты предназначены для упрощения процесса управления товарными данными и поддержания актуальности информации о товарах.

## Функциональность

### Яндекс.Маркет (`market.py`)

* **Получение списка товаров:**
    * Скрипт запрашивает у API Яндекс.Маркета список товаров магазина, используя идентификатор кампании и токен доступа.
    * Поддерживается пагинация для обработки большого количества товаров.
* **Обновление остатков:**
    * Скрипт формирует список остатков на основе данных из внешнего источника (сайт Casio).
    * Остатки обновляются через API Яндекс.Маркета, с учетом идентификатора склада.
    * Поддерживается разбиение списка остатков на части для обработки ограничений API.
* **Обновление цен:**
    * Скрипт формирует список цен на основе данных из внешнего источника.
    * Цены обновляются через API Яндекс.Маркета.
    * Поддерживается разбиение списка цен на части для обработки ограничений API.
* **Обработка данных:**
    * Скрипт обрабатывает данные об остатках, включая преобразование значений типа ">10" и "1" в числовые значения.
    * Скрипт преобразует цены из строкового формата в числовой.
* **Обработка ошибок:**
    * Скрипт обрабатывает ошибки сетевых запросов и другие исключения, выводя сообщения об ошибках в консоль.

### Ozon (`seller.py`)

* **Получение списка товаров:**
    * Скрипт запрашивает у API Ozon список товаров магазина, используя идентификатор клиента и токен продавца.
    * Поддерживается пагинация для обработки большого количества товаров.
* **Обновление остатков:**
    * Скрипт формирует список остатков на основе данных из внешнего источника.
    * Остатки обновляются через API Ozon.
    * Поддерживается разбиение списка остатков на части для обработки ограничений API.
* **Обновление цен:**
    * Скрипт формирует список цен на основе данных из внешнего источника.
    * Цены обновляются через API Ozon.
    * Поддерживается разбиение списка цен на части для обработки ограничений API.
* **Загрузка данных об остатках:**
    * Скрипт загружает ZIP-архив с остатками с сайта Casio, извлекает Excel-файл и обрабатывает его.
* **Обработка данных:**
    * Скрипт обрабатывает данные об остатках, включая преобразование значений типа ">10" и "1" в числовые значения.
    * Скрипт преобразует цены из строкового формата в числовой.
* **Обработка ошибок:**
    * Скрипт обрабатывает ошибки сетевых запросов и другие исключения, выводя сообщения об ошибках в консоль.

## Использование

1.  Настройте переменные окружения в файле `.env`.
2.  Запустите соответствующий скрипт:
    * Для Яндекс.Маркета: `python market.py`
    * Для Ozon: `python seller.py`

## Зависимости

Проект использует следующие библиотеки:

* `requests`: Для выполнения HTTP-запросов к API маркетплейсов.
* `environs`: Для работы с переменными окружения.
* `pandas`: Для обработки данных из Excel-файла.
* `openpyxl`: Для работы с файлами Excel.

## Логирование

Скрипты используют библиотеку `logging` для записи информации о работе. Настройки логирования можно изменить в скриптах.

## Обработка ошибок

Скрипты обрабатывают ошибки сетевых запросов и другие исключения, выводя информативные сообщения об ошибках.
